The algorithm is basically the same algorithm from scipy.
